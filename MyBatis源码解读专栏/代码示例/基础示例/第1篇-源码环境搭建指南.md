# ç¬¬1ç¯‡ï¼šMyBatis 3.x æºç ç¯å¢ƒæ­å»ºæŒ‡å—

## ğŸ¯ æ­å»ºç›®æ ‡

é€šè¿‡æœ¬æŒ‡å—ï¼Œä½ å°†èƒ½å¤Ÿï¼š
1. æˆåŠŸæ­å»º MyBatis 3.x çš„æºç ç¯å¢ƒ
2. é…ç½® IDE è¿›è¡Œæºç è°ƒè¯•
3. åˆ›å»ºæµ‹è¯•é¡¹ç›®éªŒè¯ç¯å¢ƒ
4. æŒæ¡æºç é˜…è¯»çš„åŸºæœ¬æŠ€å·§

## ğŸ“‹ ç¯å¢ƒè¦æ±‚

### åŸºç¡€ç¯å¢ƒ
- **JDK**: 8 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ˆæ¨è JDK 11ï¼‰
- **Maven**: 3.6 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Git**: ç”¨äºå…‹éš†æºç 
- **IDE**: IntelliJ IDEAï¼ˆæ¨èï¼‰æˆ– Eclipse

### æ•°æ®åº“ç¯å¢ƒ
- **MySQL**: 5.7 æˆ–æ›´é«˜ç‰ˆæœ¬
- **H2**: ç”¨äºæµ‹è¯•ï¼ˆå¯é€‰ï¼‰

## ğŸš€ è¯¦ç»†æ­å»ºæ­¥éª¤

### æ­¥éª¤1ï¼šå…‹éš†æºç ä»“åº“

```bash
# 1. å…‹éš† MyBatis 3.x æºç 
git clone https://github.com/mybatis/mybatis-3.git
cd mybatis-3

# 2. æŸ¥çœ‹å¯ç”¨ç‰ˆæœ¬
git tag | grep -E "^3\." | tail -10

# 3. åˆ‡æ¢åˆ°æœ€æ–°ç¨³å®šç‰ˆæœ¬ï¼ˆä»¥ 3.5.17 ä¸ºä¾‹ï¼‰
git checkout 3.5.17

# 4. éªŒè¯åˆ‡æ¢æˆåŠŸ
git branch
git log --oneline -5
```

### æ­¥éª¤2ï¼šIDE å¯¼å…¥é…ç½®

#### IntelliJ IDEA é…ç½®

1. **æ‰“å¼€é¡¹ç›®**
   ```
   File â†’ Open â†’ é€‰æ‹© mybatis-3 ç›®å½• â†’ OK
   ```

2. **ç­‰å¾…ç´¢å¼•å®Œæˆ**
   - ç­‰å¾… IDEA å®Œæˆé¡¹ç›®ç´¢å¼•
   - ç­‰å¾… Maven ä¾èµ–ä¸‹è½½å®Œæˆ
   - ç¡®ä¿æ²¡æœ‰çº¢è‰²é”™è¯¯æç¤º

3. **é…ç½® JDK**
   ```
   File â†’ Project Structure â†’ Project â†’ Project SDK
   é€‰æ‹© JDK 8 æˆ–æ›´é«˜ç‰ˆæœ¬
   ```

4. **é…ç½® Maven**
   ```
   File â†’ Settings â†’ Build, Execution, Deployment â†’ Build Tools â†’ Maven
   ç¡®ä¿ Maven home directory å’Œ User settings file é…ç½®æ­£ç¡®
   ```

#### Eclipse é…ç½®

1. **å¯¼å…¥é¡¹ç›®**
   ```
   File â†’ Import â†’ Existing Maven Projects â†’ Next
   é€‰æ‹© mybatis-3 ç›®å½• â†’ Finish
   ```

2. **é…ç½® JDK**
   ```
   å³é”®é¡¹ç›® â†’ Properties â†’ Java Build Path â†’ Libraries
   ç§»é™¤é»˜è®¤ JREï¼Œæ·»åŠ æ­£ç¡®çš„ JDK
   ```

### æ­¥éª¤3ï¼šéªŒè¯ç¯å¢ƒ

#### ç¼–è¯‘æºç 

```bash
# åœ¨ mybatis-3 ç›®å½•ä¸‹æ‰§è¡Œ
mvn clean compile

# é¢„æœŸè¾“å‡ºï¼šBUILD SUCCESS
```

#### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
mvn test

# è¿è¡Œç‰¹å®šæµ‹è¯•
mvn test -Dtest=SqlSessionTest
```

#### æ‰“åŒ…é¡¹ç›®

```bash
# æ‰“åŒ…æºç 
mvn clean package

# é¢„æœŸè¾“å‡ºï¼šåœ¨ target ç›®å½•ä¸‹ç”Ÿæˆ mybatis-3.5.17.jar
```

### æ­¥éª¤4ï¼šåˆ›å»ºæµ‹è¯•é¡¹ç›®

#### åˆ›å»ºæµ‹è¯• Module

1. **åœ¨ IDEA ä¸­åˆ›å»ºæ–° Module**
   ```
   File â†’ New â†’ Module â†’ Maven â†’ Next
   Module name: mybatis-test
   GroupId: com.example
   ArtifactId: mybatis-test
   Version: 1.0-SNAPSHOT
   ```

2. **é…ç½® pom.xml**
   ```xml
   <?xml version="1.0" encoding="UTF-8"?>
   <project xmlns="http://maven.apache.org/POM/4.0.0"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
            http://maven.apache.org/xsd/maven-4.0.0.xsd">
       <modelVersion>4.0.0</modelVersion>
       
       <groupId>com.example</groupId>
       <artifactId>mybatis-test</artifactId>
       <version>1.0-SNAPSHOT</version>
       
       <properties>
           <maven.compiler.source>11</maven.compiler.source>
           <maven.compiler.target>11</maven.compiler.target>
           <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
       </properties>
       
       <dependencies>
           <!-- MyBatis ä¾èµ– -->
           <dependency>
               <groupId>org.mybatis</groupId>
               <artifactId>mybatis</artifactId>
               <version>3.5.17</version>
           </dependency>
           
           <!-- æ•°æ®åº“é©±åŠ¨ -->
           <dependency>
               <groupId>mysql</groupId>
               <artifactId>mysql-connector-java</artifactId>
               <version>8.0.33</version>
           </dependency>
           
           <!-- æµ‹è¯•ä¾èµ– -->
           <dependency>
               <groupId>junit</groupId>
               <artifactId>junit</artifactId>
               <version>4.13.2</version>
               <scope>test</scope>
           </dependency>
       </dependencies>
   </project>
   ```

#### åˆ›å»ºæµ‹è¯•ä»£ç 

1. **åˆ›å»ºå®ä½“ç±»**
   ```java
   package com.example.mybatis.test;
   
   public class User {
       private Integer id;
       private String name;
       private String email;
       
       // æ„é€ å‡½æ•°ã€getterã€setter
       public User() {}
       
       public User(Integer id, String name, String email) {
           this.id = id;
           this.name = name;
           this.email = email;
       }
       
       // getter å’Œ setter æ–¹æ³•
       public Integer getId() { return id; }
       public void setId(Integer id) { this.id = id; }
       
       public String getName() { return name; }
       public void setName(String name) { this.name = name; }
       
       public String getEmail() { return email; }
       public void setEmail(String email) { this.email = email; }
       
       @Override
       public String toString() {
           return "User{id=" + id + ", name='" + name + "', email='" + email + "'}";
       }
   }
   ```

2. **åˆ›å»º Mapper æ¥å£**
   ```java
   package com.example.mybatis.test;
   
   public interface UserMapper {
       User selectById(Integer id);
       int insert(User user);
       int update(User user);
       int delete(Integer id);
   }
   ```

3. **åˆ›å»º Mapper XML**
   ```xml
   <!-- src/main/resources/UserMapper.xml -->
   <?xml version="1.0" encoding="UTF-8" ?>
   <!DOCTYPE mapper
           PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
           "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
   
   <mapper namespace="com.example.mybatis.test.UserMapper">
       <select id="selectById" parameterType="int" resultType="com.example.mybatis.test.User">
           SELECT id, name, email FROM users WHERE id = #{id}
       </select>
       
       <insert id="insert" parameterType="com.example.mybatis.test.User">
           INSERT INTO users(name, email) VALUES(#{name}, #{email})
       </insert>
       
       <update id="update" parameterType="com.example.mybatis.test.User">
           UPDATE users SET name = #{name}, email = #{email} WHERE id = #{id}
       </update>
       
       <delete id="delete" parameterType="int">
           DELETE FROM users WHERE id = #{id}
       </delete>
   </mapper>
   ```

4. **åˆ›å»ºé…ç½®æ–‡ä»¶**
   ```xml
   <!-- src/main/resources/mybatis-config.xml -->
   <?xml version="1.0" encoding="UTF-8" ?>
   <!DOCTYPE configuration
           PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
           "http://mybatis.org/dtd/mybatis-3-config.dtd">
   
   <configuration>
       <environments default="development">
           <environment id="development">
               <transactionManager type="JDBC"/>
               <dataSource type="POOLED">
                   <property name="driver" value="com.mysql.cj.jdbc.Driver"/>
                   <property name="url" value="jdbc:mysql://localhost:3306/test?useSSL=false&amp;serverTimezone=UTC"/>
                   <property name="username" value="root"/>
                   <property name="password" value="password"/>
               </dataSource>
           </environment>
       </environments>
       
       <mappers>
           <mapper resource="UserMapper.xml"/>
       </mappers>
   </configuration>
   ```

5. **åˆ›å»ºæµ‹è¯•ç±»**
   ```java
   package com.example.mybatis.test;
   
   import org.apache.ibatis.io.Resources;
   import org.apache.ibatis.session.SqlSession;
   import org.apache.ibatis.session.SqlSessionFactory;
   import org.apache.ibatis.session.SqlSessionFactoryBuilder;
   
   import java.io.IOException;
   import java.io.InputStream;
   
   public class MyBatisTest {
       public static void main(String[] args) {
           try {
               // 1. åŠ è½½é…ç½®æ–‡ä»¶
               String resource = "mybatis-config.xml";
               InputStream inputStream = Resources.getResourceAsStream(resource);
               
               // 2. åˆ›å»º SqlSessionFactory
               SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);
               
               // 3. åˆ›å»º SqlSession
               SqlSession session = sqlSessionFactory.openSession();
               
               // 4. è·å– Mapper
               UserMapper mapper = session.getMapper(UserMapper.class);
               
               // 5. æ‰§è¡ŒæŸ¥è¯¢
               User user = mapper.selectById(1);
               System.out.println("æŸ¥è¯¢ç»“æœ: " + user);
               
               // 6. å…³é—­ä¼šè¯
               session.close();
               
           } catch (IOException e) {
               e.printStackTrace();
           }
       }
   }
   ```

### æ­¥éª¤5ï¼šé…ç½®æ•°æ®åº“

#### åˆ›å»ºæµ‹è¯•æ•°æ®åº“

```sql
-- åˆ›å»ºæ•°æ®åº“
CREATE DATABASE test CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- ä½¿ç”¨æ•°æ®åº“
USE test;

-- åˆ›å»ºç”¨æˆ·è¡¨
CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL,
    email VARCHAR(100) NOT NULL
);

-- æ’å…¥æµ‹è¯•æ•°æ®
INSERT INTO users(name, email) VALUES 
('å¼ ä¸‰', 'zhangsan@example.com'),
('æå››', 'lisi@example.com'),
('ç‹äº”', 'wangwu@example.com');
```

### æ­¥éª¤6ï¼šéªŒè¯ç¯å¢ƒ

#### è¿è¡Œæµ‹è¯•

1. **è¿è¡Œæµ‹è¯•ç±»**
   ```bash
   # åœ¨æµ‹è¯• Module ç›®å½•ä¸‹
   mvn compile exec:java -Dexec.mainClass="com.example.mybatis.test.MyBatisTest"
   ```

2. **é¢„æœŸè¾“å‡º**
   ```
   æŸ¥è¯¢ç»“æœ: User{id=1, name='å¼ ä¸‰', email='zhangsan@example.com'}
   ```

#### è°ƒè¯•æµ‹è¯•

1. **åœ¨å…³é”®ä½ç½®è®¾ç½®æ–­ç‚¹**
   - `SqlSessionFactoryBuilder.build()`
   - `SqlSessionFactory.openSession()`
   - `SqlSession.getMapper()`
   - `UserMapper.selectById()`

2. **å¯åŠ¨è°ƒè¯•**
   - å³é”®æµ‹è¯•ç±» â†’ Debug 'MyBatisTest'
   - é€æ­¥æ‰§è¡Œï¼Œè§‚å¯Ÿå˜é‡å˜åŒ–

## ğŸ”§ æºç é˜…è¯»æŠ€å·§

### 1. é˜…è¯»é¡ºåº

1. **ä»æ¥å£å¼€å§‹**
   - å…ˆé˜…è¯»æ¥å£å®šä¹‰
   - ç†è§£è®¾è®¡æ„å›¾
   - æŒæ¡æ–¹æ³•ç­¾å

2. **è·Ÿè¸ªå®ç°**
   - ä»æ¥å£è·Ÿè¸ªåˆ°å®ç°ç±»
   - ç†è§£å®ç°é€»è¾‘
   - æŒæ¡è®¾è®¡æ¨¡å¼åº”ç”¨

3. **ç†è§£åä½œ**
   - ç†è§£ç»„ä»¶é—´åä½œå…³ç³»
   - æŒæ¡æ•°æ®æµè½¬è¿‡ç¨‹
   - ç†è§£ç”Ÿå‘½å‘¨æœŸç®¡ç†

### 2. è°ƒè¯•æŠ€å·§

1. **è®¾ç½®æ–­ç‚¹**
   - åœ¨å…³é”®æ–¹æ³•å…¥å£è®¾ç½®æ–­ç‚¹
   - åœ¨å…³é”®é€»è¾‘å¤„è®¾ç½®æ–­ç‚¹
   - åœ¨å¼‚å¸¸å¤„ç†å¤„è®¾ç½®æ–­ç‚¹

2. **è§‚å¯Ÿå˜é‡**
   - è§‚å¯Ÿæ–¹æ³•å‚æ•°
   - è§‚å¯Ÿå±€éƒ¨å˜é‡
   - è§‚å¯Ÿå¯¹è±¡çŠ¶æ€

3. **è·Ÿè¸ªè°ƒç”¨æ ˆ**
   - ç†è§£æ–¹æ³•è°ƒç”¨å…³ç³»
   - æŒæ¡æ‰§è¡Œæµç¨‹
   - ç†è§£è®¾è®¡æ¨¡å¼åº”ç”¨

### 3. ç¬”è®°è®°å½•

1. **è®°å½•å…³é”®æ¦‚å¿µ**
   - è®°å½•é‡è¦æ¥å£å’Œç±»
   - è®°å½•è®¾è®¡æ¨¡å¼åº”ç”¨
   - è®°å½•å…³é”®ç®—æ³•é€»è¾‘

2. **ç»˜åˆ¶å›¾è¡¨**
   - ç»˜åˆ¶ç±»å›¾å…³ç³»
   - ç»˜åˆ¶æ—¶åºå›¾
   - ç»˜åˆ¶æ¶æ„å›¾

3. **ç¼–å†™ç¤ºä¾‹**
   - ç¼–å†™æµ‹è¯•ä»£ç 
   - éªŒè¯ç†è§£æ­£ç¡®æ€§
   - åŠ æ·±è®°å¿†

## âœ… ç¯å¢ƒéªŒè¯æ¸…å•

å®Œæˆç¯å¢ƒæ­å»ºåï¼Œè¯·æ£€æŸ¥ä»¥ä¸‹é¡¹ç›®ï¼š

- [ ] æºç èƒ½å¤ŸæˆåŠŸç¼–è¯‘
- [ ] æµ‹è¯•èƒ½å¤ŸæˆåŠŸè¿è¡Œ
- [ ] èƒ½å¤Ÿåœ¨æºç ä¸­è®¾ç½®æ–­ç‚¹
- [ ] èƒ½å¤Ÿè¿›è¡Œè°ƒè¯•å’Œå•æ­¥æ‰§è¡Œ
- [ ] èƒ½å¤Ÿä½¿ç”¨ IDE çš„ä»£ç å¯¼èˆªåŠŸèƒ½
- [ ] æµ‹è¯•é¡¹ç›®èƒ½å¤Ÿæ­£å¸¸è¿è¡Œ
- [ ] æ•°æ®åº“è¿æ¥æ­£å¸¸
- [ ] èƒ½å¤Ÿæ‰§è¡ŒåŸºæœ¬çš„ CRUD æ“ä½œ

## ğŸ¯ ä¸‹ä¸€æ­¥å­¦ä¹ 

ç¯å¢ƒæ­å»ºå®Œæˆåï¼Œä½ å¯ä»¥ï¼š

1. **å¼€å§‹ç¬¬1ç¯‡å­¦ä¹ **ï¼šé˜…è¯» MyBatis æ•´ä½“æ¶æ„è®¾è®¡
2. **å®è·µæºç é˜…è¯»**ï¼šæŒ‰ç…§æ–‡ç« å†…å®¹è¿›è¡Œæºç åˆ†æ
3. **ç»˜åˆ¶æ¶æ„å›¾**ï¼šæ ¹æ®ç†è§£ç»˜åˆ¶ MyBatis æ¶æ„å›¾
4. **å‡†å¤‡ç¬¬2ç¯‡**ï¼šä¸ºé…ç½®ç³»ç»Ÿæºç åˆ†æåšå‡†å¤‡

**é‡è¦æç¤º**ï¼šæºç ç¯å¢ƒæ­å»ºæ˜¯å­¦ä¹ çš„åŸºç¡€ï¼Œç¡®ä¿ç¯å¢ƒæ­å»ºæ­£ç¡®åï¼Œå†å¼€å§‹æ·±å…¥çš„å­¦ä¹ ã€‚é‡åˆ°é—®é¢˜åŠæ—¶è§£å†³ï¼Œä¸è¦æ€¥äºæ±‚æˆã€‚

---

**ç¯å¢ƒæ­å»ºå®Œæˆï¼å¼€å§‹ä½ çš„ MyBatis æºç å­¦ä¹ ä¹‹æ—…å§ï¼** ğŸš€

